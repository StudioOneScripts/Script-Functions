<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>S1 Utility Functions API</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; display: flex; background-color: #ffffff; color: #333; }
    header { background: #2c3e50; color: #ecf0f1; padding: 20px; text-align: center; }
    header h1 { margin: 0; font-size: 2em; }
    #sidebar { position: fixed; top: 0; left: 0; height: 100%; width: 240px; background: #34495e; padding-top: 20px; overflow-y: auto; }
    #sidebar h2 { color: #ecf0f1; text-align: center; font-size: 1.2em; margin-bottom: 20px; }
    #sidebar a { display: block; color: #ecf0f1; padding: 10px 16px; text-decoration: none; font-size: 0.95em; font-weight: bold; }
    #sidebar a:hover { text-decoration: underline; }
    main { margin-left: 260px; padding: 24px; flex: 1; }
    section h2 { border-bottom: 1px solid #ccc; padding-bottom: 6px; margin-top: 40px; }
    code { font-family: monospace; font-size: 1.05em; font-weight: bold; color: #0b3d91; }
    pre { background: #1e1e1e; color: #dcdcdc; padding: 12px; border-radius: 6px; overflow-x: auto; line-height: 1.45; }
    .keyword { color: #569cd6; font-weight: bold; }
    .string { color: #d69d85; }
    .comment { color: #6a9955; font-style: italic; }
    .function { color: #4ec9b0; }
    .number { color: #b5cea8; }
    ul { list-style-type: none; padding: 0; margin: 0; }
    li { margin: 8px 0; }
    .note { font-size: 0.9em; color: #666; }
    footer { background: #2c3e50; color: #ecf0f1; text-align: center; padding: 10px; margin-top: 40px; }
  </style>
</head>
<body>
  <div id="sidebar">
    <h2>Navigation</h2>
    <a href="#overview">Overview</a>
    <a href="#core">Core</a>
    <a href="#transport">Transport & Filters</a>
    <a href="#root-mixer">Root / Mixer</a>
    <a href="#tracks">Tracks & Color</a>
    <a href="#channels">Channels</a>
    <a href="#mixer-reset">Mixer Reset</a>
    <a href="#fileio">File I/O & Song Ops</a>
    <a href="#engine">Engine</a>
    <a href="#windows">Windows & Headers</a>
    <a href="#utilities">Utilities & Helpers</a>
  </div>

  <main>
    <header>
      <h1>S1 Utility Functions API</h1>
      <p>Helper functions for PreSonus Studio One scripting</p>
    </header>

    <section id="overview">
      <h2>Overview</h2>
      <p>This API groups helper methods into categories for transport, mixer, track/channel management, mixer reset, file I/O & song operations, engine helpers, window management, and general utilities.</p>
      <p class="note">⚠️ Many functions directly manipulate the current song/mixer. Use with care.</p>
    </section>

    <section id="core">
      <h2>Core</h2>
      <ul>
        <li><code>S1()</code> → Initializes the namespace.</li>
        <li><code>S1.runCommand(context, command)</code> → Runs a Studio One command.</li>
        <li><code>S1.getVersion()</code> → Returns the Studio One version string (e.g., <code>7.x.x</code>).</li>
      </ul>
      <h3>Example</h3>
      <pre><span class="comment">// Run a command to add a new instrument track</span>
<span class="function">S1.runCommand</span>(<span class="string">"Track"</span>, <span class="string">"Add Instrument Track"</span>)
<span class="keyword">if</span> (this.result != <span class="number">0</span>) { <span class="keyword">return</span> } <span class="comment">// did not click OK</span></pre>
    </section>

    <section id="transport">
      <h2>Transport & Filters</h2>
      <ul>
        <li><code>S1.getTransport()</code> → Returns the active <em>TransportPanel</em> object.</li>
        <li><code>S1.getTrackFilter()</code> → Returns the <em>TrackListFilter</em>.</li>
        <li><code>S1.getChannelFilter()</code> → Returns the <em>ChannelFilter</em> (MixerConsole).</li>
        <li><code>S1.getHeaderTrackFilter()</code> → Returns the header track filter (<em>TrackListFilter1</em>).</li>
      </ul>
    </section>

    <section id="root-mixer">
      <h2>Root / Mixer</h2>
      <ul>
        <li><code>S1.getMixer()</code> → Returns the MixerConsole object.</li>
        <li><code>S1.getMasterBus()</code> → Returns the Master bus channel.</li>
      </ul>
    </section>

    <section id="tracks">
      <h2>Tracks & Color</h2>
      <ul>
        <li><code>S1.getTrackList()</code> → Returns the main track list.</li>
        <li><code>S1.getTracks()</code> → Returns all tracks.</li>
        <li><code>S1.getSelectedTracks()</code> → Returns selected tracks.</li>
        <li><code>S1.disableMutedTracks()</code> → Disables muted channels and unmutes them.</li>
        <li><code>S1.colorTrack(context, track, hexColor)</code> → Colors a track using a hex string (e.g., <code>"0b6352"</code>).</li>
        <li><code>S1.normalizeTrackNames(context)</code> → Title-cases track names.</li>
        <li><code>S1.removeEmptyTracks(context)</code> → Removes empty Audio/Music tracks.</li>
        <li><code>S1.getArrangeItems()</code> → Returns the Arrange/TrackList object. <span class="note">Note: Function references <code>version</code> variable internally; ensure it’s defined or remove that line.</span></li>
      </ul>
      <h3>Example</h3>
      <pre><span class="comment">// Color all tracks green</span>
<span class="keyword">let</span> green = <span class="string">"0b6352"</span>
<span class="keyword">let</span> Tracks = <span class="function">S1.getTracks</span>();
<span class="keyword">for</span> (<span class="keyword">let</span> track of Tracks)
    <span class="function">S1.colorTrack</span>(context, track, green)</pre>
    </section>

    <section id="channels">
      <h2>Channels</h2>
      <ul>
        <li><code>S1.getChannels()</code> → Returns all mixer channels (ChannelList type 1).</li>
        <li><code>S1.getSelectedChannels()</code> → Returns selected mixer channels.</li>
        <li><code>S1.getChannelList()</code> → Returns the mixer ChannelList (type 1).</li>
        <li><code>S1.removeChannelPrefixes()</code> → Strips prefix like <code>001 - </code> from channel labels.</li>
        <li><code>S1.prefixMixerChannels()</code> → Adds 3‑digit prefixes to non‑MusicTrack channels.</li>
        <li><code>S1.removechannelNotes()</code> → Clears channel notepad text. </li>
      </ul>
      <h3>Example</h3>
      <pre><span class="comment">// Open the console and print channel names</span>
<span class="function">S1.openWindow</span>(<span class="string">"MessageWindow"</span>)
<span class="keyword">let</span> Channels = <span class="function">S1.getChannels</span>()
<span class="keyword">for</span> (<span class="keyword">let</span> channel of Channels)
    <span class="function">print</span>(channel.label)</pre>
    </section>

    <section id="mixer-reset">
      <h2>Mixer Reset</h2>
      <ul>
        <li><code>S1.resetMixer()</code> → Confirmation dialog; resets input gain, polarity, pan, faders (to -∞), VCA, speaker setup, and bypasses all global FX.</li>
        <li><code>S1.resetInputGain(selected)</code> → Resets Input FX gain (all or selected channels).</li>
        <li><code>S1.resetPolarity(selected)</code> → Resets Input FX invert phase L/R.</li>
        <li><code>S1.resetPan(selected)</code> → Centers pan (0.5).</li>
        <li><code>S1.fadersToUnity(selected)</code> → Sets volume to unity (1.0).</li>
        <li><code>S1.fadersToInfinty(selected)</code> → Sets volume to 0 (−∞). <span class="note">Typo preserved from source.</span></li>
        <li><code>S1.resetVCA(selected)</code> → Clears VCA assignments.</li>
        <li><code>S1.resetSpeaker(selected)</code> → Sets speaker setup param to 1.</li>
        <li><code>S1.panChannelPairs()</code> → Pans selected channels alternately L/R.</li>
      </ul>
    </section>

    <section id="fileio">
      <h2>File I/O & Song Operations</h2>
      <ul>
        <li><code>S1.writeTextFile(folder, filename, text)</code> → Writes a text file under <code>$USERCONTENT/Script Support/&lt;folder&gt;</code>.</li>
        <li><code>S1.readTextFile(folder, filename)</code> → Reads a text file into an array of lines.</li>
        <li><code>S1.saveNewVersion(name)</code> → <em>File → Save New Version…</em> with description.</li>
        <li><code>S1.getLegalFileName(fileName)</code> → Replaces illegal filename chars with underscores.</li>
      </ul>

      <h3>Example</h3>
      <pre><span class="comment">// Write a text file to user data folder</span>
<span class="function">S1.writeTextFile</span>(<span class="string">"Test Folder"</span>, <span class="string">"Testfile"</span>, <span class="string">"Hello World!"</span>)

<span class="comment">// Read a text file from user data folder</span>
<span class="function">S1.readTextFile</span>(<span class="string">"Test Folder"</span>, <span class="string">"Testfile"</span>)</pre>
    </section>

    <section id="engine">
      <h2>Engine</h2>
      <ul>
        <li><code>S1.getAudioDeviceName()</code> → Returns the current audio device name.</li>
      </ul>
    </section>

    <section id="windows">
      <h2>Windows & Headers</h2>
      <ul>
        <li><code>S1.openWindow(window)</code> → Opens a Studio One window.</li>
        <li><code>S1.closeWindow(window)</code> → Closes a Studio One window.</li>
        <li><code>S1.closeHeaderTracks()</code> → Closes Tempo/Signature editors and hides Marker/Chord/Lyrics/Arranger/Video tracks; hides secondary ruler.</li>
      </ul>
      <h3>Example</h3>
      <pre><span class="comment">// Close all header tracks</span>
<span class="keyword">let</span> tracks = [<span class="string">"Marker"</span>, <span class="string">"Chord"</span>, <span class="string">"Arranger"</span>, <span class="string">"Lyrics"</span>, <span class="string">"Video"</span>]
<span class="keyword">let</span> filter = <span class="function">S1.getHeaderTrackFilter</span>();
<span class="keyword">for</span> (<span class="keyword">let</span> track of tracks)
    filter.findParameter(track + <span class="string">"Track"</span>).setValue(<span class="number">0</span>, <span class="keyword">true</span>)</pre>
      <h3>Useful Window Names</h3>
      <pre>
BigTimeDisplay, Browser, ChordDisplay, Console, Editor,
Inspector, LyricsDisplay, MetronomeSetup, MidiMonitor,
PerformanceMonitor, PluginManager, RecordPanel, 
SignatureEditor, SongInformation, SongToolbar, SynthRack,
TempoEditor, TrackList, VideoPlayer
      </pre>
    </section>

    <section id="utilities">
      <h2>Utilities & Helpers</h2>
      <ul>
        <li><code>print(msg)</code> → Writes to Studio One console.</li>
        <li><code>alert(msg)</code> → Shows alert dialog.</li>
        <li><code>ask(msg)</code> → Shows Yes/No; returns selection.</li>
        <li><code>getAllPropertyNames(obj)</code> → Logs all property names by prototype chain.</li>
      </ul>

      <h3>Example</h3>
      <pre><span class="comment">// Ask a question</span>
<span class="keyword">let</span> retVal = <span class="function">ask</span>(<span class="string">"Do you want to do this?"</span>)
<span class="keyword">if</span> (retVal === <span class="number">1</span>)  <span class="comment">// you clicked 'No'</span>
    <span class="keyword">return</span>;

<span class="comment">// Otherwise do the thing...</span>
<span class="function">alert</span>(<span class="string">"You clicked yes..."</span>)</pre>
    </section>

    <footer>
      <p>© 2025 S1 Utility Functions Documentation</p>
    </footer>
  </main>
</body>
</html>